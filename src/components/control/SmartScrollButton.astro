---
import { Icon } from "astro-icon/components";

interface Props {
	// 接收外部传入的类名
	class?: string;
}

const { class: customClass = "" } = Astro.props;
---

<div class="smart-scroll-wrapper hidden lg:block">
    <!-- 将外部类名添加到按钮元素上 -->
    <div id="smart-scroll-btn" 
         class={`smart-scroll-btn hide flex items-center rounded-2xl overflow-hidden transition ${customClass}`}
         onclick="smartScroll()">
        <button aria-label="Smart Scroll" class="btn-card h-[3.75rem] w-[3.75rem]">
            <div id="scroll-icon-container" class="mx-auto transition-transform duration-200">
                <Icon id="scroll-up-icon" name="material-symbols:keyboard-arrow-up-rounded" class="block text-[var(--primary)] text-2xl"></Icon>
                <Icon id="scroll-down-icon" name="material-symbols:keyboard-arrow-down-rounded" class="hidden text-[var(--primary)] text-2xl"></Icon>
            </div>
        </button>
    </div>
</div>

<style lang="stylus">
.smart-scroll-wrapper
    width: 3.75rem
    height: 3.75rem
    position: absolute
    right: 0
    top: 0
    z-index: 50
    pointer-events: none

.smart-scroll-btn
    position: fixed
    pointer-events: auto
    transition: all 0.2s
    /* 移除硬编码的位置值，改为默认通过类名控制 */
    right: 6rem  // 保留默认右侧距离，可被类名覆盖
    bottom: 23rem // 保留默认底部距离，可被类名覆盖
    
    &.hide
        transform: translateX(5rem)
        opacity: 0
        pointer-events: none
</style>

<script>
function smartScroll() {
    const scrollUpIcon = document.getElementById('scroll-up-icon');
    const scrollDownIcon = document.getElementById('scroll-down-icon');
    
    if (scrollDownIcon && !scrollDownIcon.classList.contains('hidden')) {
        window.scrollBy({
            top: window.innerHeight * 2,
            behavior: 'smooth'
        });
    } else if (scrollUpIcon && !scrollUpIcon.classList.contains('hidden')) {
        window.scrollBy({
            top: -window.innerHeight * 2,
            behavior: 'smooth'
        });
    }
}

declare global {
    interface Window {
        smartScroll: () => void;
    }
}

(window as any).smartScroll = smartScroll;
</script>
    